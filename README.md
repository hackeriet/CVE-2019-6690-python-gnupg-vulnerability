# python-gnupg 0.4.3: Improper Input Validation

We discovered a way to inject data trough the passphrase property of the
gnupg.encrypt() and gnupg.decrypt() methods when symmetric encryption is used.

The supplied passphrase is not validated for newlines, and the library passes
`--passphrase-fd=0` to the gpg executable, which expects the passphrase on the
first line of stdin, and the ciphertext to be decrypted or plaintext to be
encrypted on sebsequent lines.

By suppling a passphrase with a newline in it an attacker can control/modify
the ciphertext/plaintext being decrypted/encrypted.

# Vulnerable

python-gnupg 0.4.3, and maybe earlier versions

# Proof of Concept

Hypothetical application using sucessful decryption of data to authenticate
user, and a way to exploit it.

## Dependencies 

Debian: `apt install libmojolicious-perl python3-gnupg python3-flask`

Nix: `nix-shell`

## Run the server

`./server.py`

## Run the exploit

`./exploit.pl`
